# План: Вертикальный Timeline для «Как мы работаем»

## Задача
Переработать блок «Как мы работаем» — сетку 3×2 карточек → вертикальный Timeline с зигзаг-лейаутом и scroll-анимациями.

## Выбранный дизайн: Концепция A «Зигзаг»

```
Desktop (md+):                    Mobile:

    ┌────────┐                      │
    │  Card  │───●                  ●───┌────────┐
    └────────┘   │                  │   │  Card  │
                 │                  │   └────────┘
          ●───┌────────┐            │
          │   │  Card  │            ●───┌────────┐
          │   └────────┘            │   │  Card  │
          │                         │   └────────┘
    ┌────────┐                      │
    │  Card  │───●                  ...
    └────────┘   │
```

**Визуальные особенности:**
- Центральная вертикальная линия с градиентом `#58A8E0` → `#3B82F6` → `#1E3A5F`
- Карточки чередуются слева/справа (desktop), все справа (mobile)
- Круглые маркеры номеров (48px) с gradient на линии
- Соединительные «усы» от линии к карточкам

**Анимации при скролле (Framer Motion):**
1. Линия «рисуется» сверху вниз (scaleY 0→1)
2. Маркеры появляются с spring-эффектом (scale 0→1)
3. Карточки slide-in с противоположной стороны
4. Stagger delay 150ms между элементами

---

## Файлы для изменения

| Файл | Действие |
|------|----------|
| `apps/web/package.json` | Добавить `framer-motion` |
| `apps/web/widgets/HowWeWork/HowWeWork.tsx` | Полностью переписать на Timeline layout |
| `apps/web/DESIGN.md` | Добавить секцию про Timeline component |

---

## Реализация

### 1. Установка зависимости

```bash
cd apps/web && pnpm add framer-motion
```

### 2. Компонент Timeline

```tsx
// HowWeWork.tsx - основная структура
'use client';

import { motion, useInView } from 'framer-motion';
import { useRef } from 'react';
import { Section } from '@/shared/ui/Section';

interface Step {
  id: number;
  title: string;
  description: string;
}

interface HowWeWorkProps {
  title: string;
  steps: Step[];
}

export function HowWeWork({ title, steps }: HowWeWorkProps) {
  const ref = useRef(null);
  const isInView = useInView(ref, { once: true, amount: 0.1 });

  return (
    <Section id="how-we-work" title={title} background="gray">
      <div ref={ref} className="relative">
        {/* Центральная линия */}
        <motion.div
          className="absolute left-6 md:left-1/2 top-0 bottom-0 w-0.5
                     bg-gradient-to-b from-[#58A8E0] via-[#3B82F6] to-[#1E3A5F]
                     origin-top md:-translate-x-1/2"
          initial={{ scaleY: 0 }}
          animate={isInView ? { scaleY: 1 } : { scaleY: 0 }}
          transition={{ duration: 1.2, ease: 'easeOut' }}
        />

        {/* Steps */}
        <div className="relative space-y-8 md:space-y-12">
          {steps.map((step, index) => (
            <TimelineItem
              key={step.id}
              step={step}
              index={index}
              isLeft={index % 2 === 0}
              isInView={isInView}
            />
          ))}
        </div>
      </div>
    </Section>
  );
}

function TimelineItem({ step, index, isLeft, isInView }) {
  return (
    <motion.div
      className={`relative flex items-start gap-4 md:gap-0
                  ${isLeft ? 'md:flex-row' : 'md:flex-row-reverse'}`}
      initial={{ opacity: 0, x: isLeft ? -30 : 30 }}
      animate={isInView ? { opacity: 1, x: 0 } : {}}
      transition={{ delay: 0.3 + index * 0.15, duration: 0.5 }}
    >
      {/* Marker */}
      <motion.div
        className="absolute left-6 md:left-1/2 -translate-x-1/2 z-10
                   w-12 h-12 rounded-full flex items-center justify-center
                   bg-gradient-to-br from-[#58A8E0] to-[#3B82F6]
                   text-white text-xl font-bold shadow-lg"
        initial={{ scale: 0 }}
        animate={isInView ? { scale: 1 } : {}}
        transition={{
          delay: 0.2 + index * 0.15,
          type: 'spring',
          stiffness: 300,
          damping: 15
        }}
      >
        {step.id}
      </motion.div>

      {/* Card */}
      <div className={`ml-16 md:ml-0 md:w-[calc(50%-3rem)]
                       ${isLeft ? 'md:pr-8' : 'md:pl-8'}`}>
        <div className="bg-white rounded-xl border border-[#F1F5F9] p-6
                        shadow-sm hover:shadow-md transition-shadow">
          <h3 className="text-lg font-semibold text-[#1E3A5F] mb-2">
            {step.title}
          </h3>
          <p className="text-[#475569] text-sm leading-relaxed">
            {step.description}
          </p>
        </div>
      </div>

      {/* Connector line to card */}
      <div className={`hidden md:block absolute top-6 h-0.5 w-8
                       bg-gradient-to-r from-[#3B82F6]/50 to-transparent
                       ${isLeft ? 'left-1/2' : 'right-1/2 rotate-180'}`} />
    </motion.div>
  );
}
```

### 3. Обновление DESIGN.md

Добавить секцию **Timeline Component** с описанием:
- Структура и layout
- Анимации и timing
- Breakpoints и responsive behaviour

---

## Спецификации анимаций

| Элемент | Анимация | Timing |
|---------|----------|--------|
| Линия | scaleY 0→1 | 1.2s ease-out |
| Маркер | scale 0→1 | spring(300, 15), delay: 0.2 + i×0.15 |
| Карточка | opacity 0→1, x ±30→0 | 0.5s, delay: 0.3 + i×0.15 |

**Trigger:** `useInView` с `once: true`, `amount: 0.1`

---

## Accessibility

- `prefers-reduced-motion`: отключить анимации, показать сразу
- Семантика: `<ol>` + `<li>` для списка шагов
- Focus states сохранены на карточках

---

## Верификация

1. `pnpm dev` — проверить страницу `/about`
2. Скролл на desktop — карточки должны появляться поочерёдно
3. Скролл на mobile — линия слева, карточки справа
4. Resize window — лейаут должен плавно переключаться
5. `pnpm lint` — без ошибок
